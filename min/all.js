var stockPrices=angular.module("stockPrices",["ui.router"]);stockPrices.config(["$stateProvider",function(t){t.state("main",{url:"/main",views:{"mainContainer@":{controller:"MainCtrl",controllerAs:"MainCtrl"}}})}]),stockPrices.run(["$state","$rootScope",function(t,e){t.go("main")}]),stockPrices.controller("MainCtrl",["$scope","$http",function(t,e){t.processData=function(e){var n=e.split(/\r\n|\n/),a=n[0].split(","),o=[],r=0,i=n.length;for(r;r<i;r++)if(n[r].indexOf(",")!=-1){var s=n[r].split(",");if(s.length==a.length){for(var l=[],c=0;c<a.length;c++)l.push(s[c]);o.push(l)}}t.data=o},t.processDeltas=function(e){var n=e.split(/\r\n|\n/),a=[],o=[],r=0,i=n.length,s=0;for(r;r<i;++r)if(n[r].indexOf(",")!=-1){var l=n[r].split(",");a.push(l)}else if(""!=n[r]){var c=n[r];s+=+c,o.push({timeout:s,deltaTable:a}),a=[]}t.applyDeltas(o)},t.applyDeltas=function(e){var n=0,a=e.length;for(n;n<a;++n){var o=e[n].deltaTable,r=e[n].timeout;!function(e,n){setTimeout(function(){for(var n=1;n<t.data.length;++n)for(var a=0;a<t.data[n].length;++a)""!=e[n-1][a]&&(t.data[n][a]=e[n-1][a]);t.$apply()},n)}(o,r)}},t.$on("fileLoaded",function(e,n){t.processDeltas(n)}),e.get("data/snapshot.csv").success(t.processData)}]),stockPrices.directive("fileUpload",["$rootScope",function(t){return{restrict:"A",link:function(e,n){n.on("click",function(){var n=document.getElementById("file").files[0],a=new FileReader;a.onloadend=function(n){e.deltas=n.target.result,t.$broadcast("fileLoaded",e.deltas)},a.readAsBinaryString(n)})}}}]);